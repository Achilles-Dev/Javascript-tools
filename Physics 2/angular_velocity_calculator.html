<!DOCTYPE html>
<html>
<head>
  <title>Angular Velocity Calculator</title>
</head>
<body>
    <h1>Angular Velocity Calculator</h1>
    <p>Easily calculate the angular velocity of an object in circular motion. Input supports metric and imperial measurement units, <br />
      radians and degrees. The angular speed calculator can also be used to solve for linear velocity and radius. <br />
      Can also convert angular speed to linear speed and vice versa.
    </p>
    <p>
      Calculate:
      <select id="calcSelect">
        <option value="avt" selected>Angular Velocity (via Time to Turn Angle)</option>
        <option value="avl">Angular Velocity (via Linear Velocity)</option>
        <option value="liv">Linear Velocity</option>
        <option value="par">Path Radius</option>
      </select>
    </p>
    <div id="avtContainer" class="containers">
      <p>
        Angle turned:
        <input type="number" id="angTVal">
        <select id="angTSelect" name="angleTurned">
          <option value="degrees" selected>degrees</option>
          <option value="radians">radians</option>
        </select>
      </p>
      <p>
        Time taken: 
        <input type="number" id="timeTVal">
        <select id="timeTSelect" name="timeTaken">
          <option value="mseconds">mseconds</option>
          <option value="seconds" selected>seconds</option>
          <option value="minutes">minutes</option>
          <option value="hours">hours</option>
          <option value="days">days</option>
          <option value="weeks">weeks</option>
          <option value="years">years</option>
          <option value="centuries">centuries</option>
        </select>
      </p>
    </div>
    <p id="parContainer" class="containers" style="display: none;">
      Linear velocity: 
      <input type="number" id="linVelVal">
      <select id="linVelSelect" name="linearVel">
        <option value="mph">miles/h</option>
        <option value="kmh">km/h</option>
        <option value="mps">miles/s</option>
        <option value="kms">km/s</option>
        <option value="ms" selected>m/s</option>
        <option value="ins">in/s</option>
        <option value="yds">yd/s</option>
        <option value="fts">ft/s</option>
        <option value="knots">knots</option>
      </select>
    </p>
    <p id="livContainer" class="containers" style="display: none;">
      Path radius: 
      <input type="number" id="pathRadVal">
      <select id="pathRadSelect" name="pathRadius">
        <option value="mm">mm</option>
        <option value="cm">cm</option>
        <option value="dm">dm</option>
        <option value="m" selected>m</option>
        <option value="km">km</option>
        <option value="in">in</option>
        <option value="ft">ft</option>
        <option value="yd">yd</option>
        <option value="mi">mi</option>
      </select>
    </p>
    <p id="bthContainer" class="containers" style="display: none;">
      Angular velocity: 
      <input type="number" id="angVelVal">
      <select id="angVelSelect" name="angularVel">
        <option value="rps" selected>Radians/s</option>
        <option value="rpm">Radians/m</option>
        <option value="rph">Radians/h</option>
        <option value="dps">Degrees/s</option>
        <option value="dpm">Degrees/m</option>
        <option value="dph">Degrees/h</option>
        <option value="revps">Rev/s (Hz)</option>
        <option value="revpm">Rev/m (rpm)</option>
        <option value="revph">Rev/h (rph)</option>
        <option value="revpd">Rev/day</option>
        <option value="revpw">Rev/week</option>
        <option value="revpy">Rev/year</option>
      </select>
    </p>

    <p id="botContainer" class="containers">
      Output in: 
      <input type="number" id="outputVal">
      <select id="outputSelect" name="output">
				<option value="radians" selected>Radians</option>
				<option value="degrees">Degrees</option>
				<option value="revolutions">Revolutions</option>
			</select>
      <select class="form-select" name="out2" id="out2">
				<option value="sec" selected>per second</option>
				<option value="min">per minute</option>
				<option value="hour">per hour</option>
				<option value="day">per day</option>
				<option value="week">per week</option>
				<option value="year">per year</option>
				<option value="cent">per century</option>
			</select>
    </p>

    <button id="calcBtn">Calculate</button>
    <button id="resetBtn">Reset</button>
    <hr>
    <div>
      <h3>Result:</h3>
      <h3 id="calcResults">Result will appear here...</h3>
    </div>

    <script>
      // Get required elements from the HTML
      const calcSelectEl = document.getElementById("calcSelect");
      const angTValEl = document.getElementById("angTVal");
      const timeTValEl = document.getElementById("timeTVal");
      const linVelValEl = document.getElementById("linVelVal");
      const pathRadValEl = document.getElementById("pathRadVal");
      const angVelValEl = document.getElementById("angVelVal");
      const outputValEl = document.getElementById("outputVal");

      const angTSelectEl = document.getElementById("angTSelect");
      const timeTSelectEl = document.getElementById("timeTSelect");
      const linVelSelectEl = document.getElementById("linVelSelect");
      const pathRadSelectEl = document.getElementById("pathRadSelect");
      const angVelSelectEl = document.getElementById("angVelSelect");
      const outputSelectEl = document.getElementById("outputSelect");

      const containtersEl = document.querySelectorAll(".containers");

      const calcBtnEl = document.getElementById('calcBtn');
      const resetBtnEl = document.getElementById('resetBtn');
      const calcResultsEl = document.getElementById('calcResults') 

      const UNITS = {
        time: {
          ns: 0,
          ms: 0,
          s: 1,
          m: 0.01666666666,
          h: 0.0002777777777777778,
          days: 0.000011574074074074073,
          wks: 0.0000016534391534391535,
          mos: 3.8025705376834734e-7,
          yrs: 3.1688087814028954e-8,
        },
      }

      /*************** FUNCTIONS ***************/
      function toSIUnit(type, unit, value) {
        return value / UNITS[type][unit];
      }

      function fromSIUnit(type, unit, value) {
        return value * UNITS[type][unit];
      }

      function handlecalcSelectChange(e) {
        const value = e.target.value

        containtersEl.forEach((container) => {
          let idVal = container.id.slice(0, 3)
          if (value == idVal) {
            container.style.display = 'block'
          } else if (idVal === 'bot' && (value == 'avt' || value === 'avl')) {
            container.style.display = 'block'
          } else if ((idVal === 'liv' || idVal === 'par') && (value === 'avl')) {
            container.style.display = 'block'
          } else if (idVal === 'bth' && (value == 'liv' || value === 'par')) {
            container.style.display = 'block'
          } else {
            container.style.display = 'none'
          }
        })
      }

      function prepareUnits() {
        let iq = parseFloat(iniQtyValEl.value) ?? 0;
        let rq = parseFloat(remQtyValEl.value) ?? 0;
        let te = parseFloat(timeValEl.value) ?? 0;
        let hl = parseFloat(document.getElementById('halfLifeVal').value) ?? 0;

        let teUnit = timeSelectEl.value;
        let hlUnit = document.getElementById('halfLifeSelect').value;

        te = toSIUnit("time", teUnit, te);
        hl = toSIUnit("time", hlUnit, hl);

        return { iq, rq, te , hl};
      }

      function calculateResults() {
          // Retrieve input values
          // const observedVal = parseFloat(observedValEl.value);
          // const trueVal = parseFloat(trueValEl.value);

          if (isNaN(observedVal) || isNaN(trueVal)) {
            alert("Please Enter All Details.");
            return;
          } else if (trueVal < 0  ) {
            alert("The relative uncertainty cannot be negative.");
              return;
          }

          try {
            const results = ((observedVal -trueVal) / trueVal) * 100
            
            calcResultsEl.innerHTML = `<p> Percent error: ${results.toFixed(2) * 1}%</p>`
          } catch (error) {
            alert("Something Went Wrong!!!");
            resethandler()
          }
      }

      function resetForm() {
        observedValEl.value = ""
        trueValEl.value = ""
      }

      function resetResult() {
        calcResultsEl.innerHTML = "<p>Result will appear here...</p>";
      } 

      function resethandler() {
        resetForm();
        resetResult();
      }

      /*************** EVENTLISTINERS ***************/
      [angTValEl, timeTValEl, linVelValEl, pathRadValEl, angVelValEl, outputValEl].forEach((el) => {
        el.addEventListener("input", resetResult);
      }); 
            
      [angTSelectEl, timeTSelectEl, linVelSelectEl, pathRadSelectEl, angVelSelectEl, outputSelectEl].forEach((el) => {
        el.addEventListener("change", resetResult);
      }); 

      calcSelectEl.addEventListener("change", handlecalcSelectChange)

      resetBtnEl.addEventListener("click", resethandler);
      calcBtnEl.addEventListener("click", calculateResults);

    </script>
</body>
</html>
